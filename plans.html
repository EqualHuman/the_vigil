<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Task List with Subtasks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #050816;
      --bg-card: rgba(15, 23, 42, 0.95);
      --bg-card-soft: rgba(15, 23, 42, 0.8);
      --accent: #6366f1;
      --accent-soft: rgba(99, 102, 241, 0.2);
      --accent-strong: #a855f7;
      --text-main: #e5e7eb;
      --text-subtle: #9ca3af;
      --border-subtle: rgba(148, 163, 184, 0.4);
      --danger: #f97373;
      --radius-xl: 18px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.9);
      --transition-fast: 0.18s ease-out;
      --transition-med: 0.25s ease-out;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      color: var(--text-main);
      background:
        radial-gradient(circle at top left, rgba(56, 189, 248, 0.14), transparent 55%),
        radial-gradient(circle at top right, rgba(129, 140, 248, 0.16), transparent 60%),
        radial-gradient(circle at bottom, rgba(244, 114, 182, 0.18), transparent 55%),
        var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px 16px;
    }

    .app-shell {
      width: 100%;
      max-width: 960px;
      background: linear-gradient(135deg, rgba(15,23,42,0.96), rgba(15,23,42,0.96));
      border-radius: 32px;
      padding: 22px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(22px);
      position: relative;
      overflow: hidden;
    }

    .app-shell::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(circle at 0% 0%, rgba(96, 165, 250, 0.18), transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(244, 114, 182, 0.18), transparent 55%);
      opacity: 0.6;
      mix-blend-mode: screen;
      z-index: 0;
    }

    .app-inner {
      position: relative;
      z-index: 1;
    }

    .app-header {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-bottom: 18px;
    }

    .app-logo {
      width: 38px;
      height: 38px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #f97316, #f97316 30%, #f97316 31%, #f97316 40%, #f97316 41%, #f97316 45%, #ef4444 70%, #4f46e5);
      box-shadow:
        0 0 25px rgba(248, 250, 252, 0.4),
        0 0 40px rgba(129, 140, 248, 0.6);
      position: relative;
      flex-shrink: 0;
    }

    .app-logo::after {
      content: "";
      position: absolute;
      inset: 18%;
      border-radius: inherit;
      border: 1px solid rgba(248, 250, 252, 0.5);
      opacity: 0.55;
    }

    .app-title-block {
      flex: 1;
    }

    .app-title {
      font-size: 1.35rem;
      font-weight: 650;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge {
      font-size: 0.65rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(129, 140, 248, 0.6);
      color: #c7d2fe;
      background: linear-gradient(135deg, rgba(79, 70, 229, 0.24), rgba(147, 51, 234, 0.24));
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .app-subtitle {
      font-size: 0.86rem;
      color: var(--text-subtle);
      margin-top: 2px;
    }

    .pill-bar {
      margin: 8px 0 18px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: space-between;
    }

    .pill-group {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .pill {
      font-size: 0.78rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(30, 64, 175, 0.45);
      border: 1px solid rgba(129, 140, 248, 0.5);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      color: #c7d2fe;
    }

    .pill span.dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 6px rgba(34, 197, 94, 0.7);
    }

    .pill-subtle {
      background: rgba(15, 23, 42, 0.8);
      border-color: rgba(148, 163, 184, 0.5);
      color: var(--text-subtle);
    }

    .pill-subtle .dot {
      background: #facc15;
      box-shadow: 0 0 6px rgba(250, 204, 21, 0.7);
    }

    .task-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.5fr) minmax(0, 2.1fr);
      gap: 18px;
    }

    @media (max-width: 800px) {
      .task-grid {
        grid-template-columns: minmax(0, 1fr);
      }
      .app-shell {
        padding: 18px;
      }
    }

    .card {
      border-radius: var(--radius-xl);
      border: 1px solid var(--border-subtle);
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.85));
      padding: 14px 14px 16px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.85);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40px;
      opacity: 0.12;
      background:
        radial-gradient(circle at top, rgba(129, 140, 248, 0.8), transparent 60%),
        radial-gradient(circle at bottom right, rgba(236, 72, 153, 0.7), transparent 60%);
      mix-blend-mode: soft-light;
      pointer-events: none;
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 12px;
      position: relative;
      z-index: 1;
    }

    .card-header-left {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .card-title {
      font-size: 0.95rem;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #e5e7eb;
    }

    .card-caption {
      font-size: 0.8rem;
      color: var(--text-subtle);
    }

    .card-header-right {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .stat-pill {
      font-size: 0.72rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.88);
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-subtle);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .stat-pill strong {
      color: #e5e7eb;
      font-weight: 600;
    }

    .button {
      border-radius: 999px;
      border: 1px solid transparent;
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: #f9fafb;
      font-size: 0.82rem;
      font-weight: 500;
      padding: 8px 14px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
      box-shadow:
        0 0 20px rgba(129, 140, 248, 0.5),
        0 10px 20px rgba(15, 23, 42, 0.8);
      transition: transform var(--transition-fast), box-shadow var(--transition-fast),
        filter var(--transition-fast);
      white-space: nowrap;
    }

    .button:hover {
      transform: translateY(-1px) scale(1.01);
      filter: brightness(1.03);
      box-shadow:
        0 0 30px rgba(129, 140, 248, 0.7),
        0 18px 35px rgba(15, 23, 42, 0.9);
    }

    .button:active {
      transform: translateY(0) scale(0.99);
      box-shadow:
        0 0 18px rgba(129, 140, 248, 0.55),
        0 10px 25px rgba(15, 23, 42, 0.9);
    }

    .button-ghost {
      background: rgba(15, 23, 42, 0.95);
      border-color: rgba(148, 163, 184, 0.8);
      color: var(--text-subtle);
      box-shadow: 0 6px 15px rgba(15, 23, 42, 0.8);
      padding-inline: 10px;
    }

    .button-ghost:hover {
      border-color: rgba(129, 140, 248, 0.8);
      color: #e5e7eb;
      box-shadow: 0 10px 20px rgba(15, 23, 42, 0.9);
    }

    .input-group {
      position: relative;
      margin-bottom: 8px;
    }

    .input-label {
      display: block;
      font-size: 0.78rem;
      color: var(--text-subtle);
      margin-bottom: 4px;
    }

    .input {
      width: 100%;
      padding: 7px 9px;
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 0.95));
      color: var(--text-main);
      font-size: 0.84rem;
      outline: none;
      transition: border-color var(--transition-fast), box-shadow var(--transition-fast),
        background-color var(--transition-fast), transform var(--transition-fast);
    }

    .input::placeholder {
      color: rgba(148, 163, 184, 0.7);
    }

    .input:focus {
      border-color: rgba(129, 140, 248, 0.95);
      box-shadow: 0 0 0 1px rgba(129, 140, 248, 0.9);
      transform: translateY(-0.5px);
    }

    .input-row {
      display: flex;
      gap: 8px;
      align-items: flex-end;
      margin-top: 6px;
    }

    .input-row .input-group {
      margin-bottom: 0;
    }

    .input-small {
      padding: 6px 8px;
      font-size: 0.8rem;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .chip {
      font-size: 0.76rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: var(--text-subtle);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      transition: background var(--transition-fast), border-color var(--transition-fast),
        color var(--transition-fast), transform var(--transition-fast);
    }

    .chip span.dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
    }

    .chip[data-priority="low"] span.dot {
      background: #22c55e;
    }

    .chip[data-priority="medium"] span.dot {
      background: #facc15;
    }

    .chip[data-priority="high"] span.dot {
      background: #f97316;
    }

    .chip[data-priority="urgent"] span.dot {
      background: #ef4444;
    }

    .chip.active {
      background: rgba(79, 70, 229, 0.28);
      border-color: rgba(129, 140, 248, 0.95);
      color: #e5e7eb;
      transform: translateY(-0.5px);
      box-shadow: 0 0 0 1px rgba(129, 140, 248, 0.8);
    }

    .task-list {
      margin-top: 4px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      position: relative;
      z-index: 1;
      max-height: 420px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .task-card {
      border-radius: 14px;
      padding: 8px 9px 9px;
      background: var(--bg-card);
      border: 1px solid rgba(75, 85, 99, 0.65);
      display: flex;
      flex-direction: column;
      gap: 5px;
      position: relative;
      transition: border-color var(--transition-fast), transform var(--transition-fast),
        box-shadow var(--transition-fast), background var(--transition-fast);
    }

    .task-card:hover {
      border-color: rgba(129, 140, 248, 0.9);
      transform: translateY(-1px);
      box-shadow: 0 10px 16px rgba(15, 23, 42, 0.9);
      background: radial-gradient(circle at top left, rgba(79, 70, 229, 0.25), transparent 55%),
        var(--bg-card-soft);
    }

    .task-main-row {
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .checkbox-wrap {
      margin-top: 2px;
      flex-shrink: 0;
    }

    .checkbox {
      width: 18px;
      height: 18px;
      border-radius: 7px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.85);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      position: relative;
      transition: border-color var(--transition-fast), background var(--transition-fast),
        box-shadow var(--transition-fast), transform var(--transition-fast);
    }

    .checkbox::after {
      content: "";
      width: 10px;
      height: 10px;
      border-radius: 4px;
      background: linear-gradient(135deg, #22c55e, #4ade80);
      transform: scale(0);
      transition: transform var(--transition-fast);
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.8);
    }

    .checkbox.completed {
      border-color: rgba(34, 197, 94, 0.95);
      background: radial-gradient(circle at 30% 20%, rgba(74, 222, 128, 0.3), rgba(15, 23, 42, 0.95));
      box-shadow: 0 0 10px rgba(22, 163, 74, 0.9);
      transform: translateY(-0.4px);
    }

    .checkbox.completed::after {
      transform: scale(1);
    }

    .task-content {
      flex: 1;
      min-width: 0;
    }

    .task-title-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 6px;
    }

    .task-title {
      font-size: 0.88rem;
      font-weight: 520;
      color: #e5e7eb;
      word-break: break-word;
    }

    .task-title.completed {
      text-decoration: line-through;
      text-decoration-thickness: 1px;
      color: rgba(148, 163, 184, 0.85);
    }

    .task-meta {
      display: inline-flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 2px;
      font-size: 0.72rem;
      color: var(--text-subtle);
      align-items: center;
    }

    .meta-chip {
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.95);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .priority-indicator {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      box-shadow: 0 0 6px currentColor;
    }

    .priority-low {
      color: #22c55e;
    }

    .priority-medium {
      color: #facc15;
    }

    .priority-high {
      color: #f97316;
    }

    .priority-urgent {
      color: #ef4444;
    }

    .task-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
      margin-top: 4px;
      justify-content: flex-end;
    }

    .icon-button {
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-subtle);
      font-size: 0.76rem;
      padding: 4px 8px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      transition: background var(--transition-fast), border-color var(--transition-fast),
        color var(--transition-fast), transform var(--transition-fast),
        box-shadow var(--transition-fast);
    }

    .icon-button:hover {
      border-color: rgba(129, 140, 248, 0.95);
      color: #e5e7eb;
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.9);
      transform: translateY(-0.5px);
    }

    .icon-button.danger {
      border-color: rgba(248, 113, 113, 0.9);
      color: #fecaca;
    }

    .icon-button.danger:hover {
      background: radial-gradient(circle at top left, rgba(248, 113, 113, 0.3), rgba(15, 23, 42, 0.96));
      box-shadow: 0 6px 14px rgba(127, 29, 29, 0.9);
    }

    .subtask-section {
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px dashed rgba(75, 85, 99, 0.9);
      padding: 6px 7px;
      margin-top: 4px;
    }

    .subtask-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-size: 0.75rem;
      color: var(--text-subtle);
      margin-bottom: 4px;
    }

    .subtask-toggle {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      border-radius: 999px;
      padding: 2px 7px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.96);
      font-size: 0.72rem;
      transition: background var(--transition-fast), border-color var(--transition-fast),
        transform var(--transition-fast);
    }

    .subtask-toggle:hover {
      border-color: rgba(129, 140, 248, 0.9);
      transform: translateY(-0.5px);
    }

    .subtask-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-top: 2px;
    }

    .subtask-item {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      font-size: 0.8rem;
      padding: 2px 1px;
    }

    .subtask-title {
      flex: 1;
      word-break: break-word;
      color: #d1d5db;
    }

    .subtask-title.completed {
      text-decoration: line-through;
      text-decoration-thickness: 1px;
      color: rgba(148, 163, 184, 0.85);
    }

    .subtask-controls {
      display: flex;
      gap: 4px;
      align-items: center;
      margin-top: 2px;
    }

    .subtask-input-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 6px;
    }

    .subtask-input-row .input-small {
      flex: 1;
    }

    .tiny-button {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-subtle);
      font-size: 0.72rem;
      padding: 4px 7px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      transition: background var(--transition-fast), color var(--transition-fast),
        border-color var(--transition-fast), transform var(--transition-fast);
      white-space: nowrap;
    }

    .tiny-button:hover {
      border-color: rgba(129, 140, 248, 0.95);
      color: #e5e7eb;
      transform: translateY(-0.4px);
    }

    .subtle-text {
      font-size: 0.76rem;
      color: var(--text-subtle);
      margin-top: 6px;
    }

    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .filter-button {
      font-size: 0.76rem;
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.95);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-subtle);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      transition: background var(--transition-fast), color var(--transition-fast),
        border-color var(--transition-fast), transform var(--transition-fast);
    }

    .filter-button.active {
      background: rgba(79, 70, 229, 0.25);
      border-color: rgba(129, 140, 248, 0.95);
      color: #e5e7eb;
      transform: translateY(-0.5px);
    }

    .filter-button span.dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: currentColor;
      opacity: 0.8;
    }

    .empty-state {
      border-radius: 12px;
      padding: 14px 10px;
      background: radial-gradient(circle at top left, rgba(79, 70, 229, 0.12), transparent 55%),
        radial-gradient(circle at bottom right, rgba(236, 72, 153, 0.1), transparent 55%),
        rgba(15, 23, 42, 0.95);
      border: 1px dashed rgba(75, 85, 99, 0.9);
      font-size: 0.82rem;
      color: var(--text-subtle);
      text-align: center;
      margin-top: 6px;
    }

    .empty-state strong {
      color: #e5e7eb;
      font-weight: 600;
    }

    .footer-note {
      margin-top: 12px;
      font-size: 0.76rem;
      color: var(--text-subtle);
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .badge-mini {
      font-size: 0.7rem;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-subtle);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(15, 23, 42, 0.9);
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(55, 65, 81, 0.9);
      border-radius: 999px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(75, 85, 99, 0.95);
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <div class="app-inner">
      <header class="app-header">
        <div class="app-logo"></div>
        <div class="app-title-block">
          <div class="app-title">
            Aurora Tasks
            <span class="badge">Shared link · Local view</span>
          </div>
          <p class="app-subtitle">
            Create tasks, break them into subtasks, and check things off in a calm, focused workspace.
          </p>
        </div>
      </header>

      <div class="pill-bar">
        <div class="pill-group">
          <span class="pill">
            <span class="dot"></span>
            Syncs to this browser
          </span>
          <span class="pill pill-subtle">
            <span class="dot"></span>
            Share the file · each person gets their own copy
          </span>
        </div>
      </div>

      <main class="task-grid">
        <section class="card">
          <div class="card-header">
            <div class="card-header-left">
              <h2 class="card-title">New task</h2>
              <p class="card-caption">Name your task, pick a priority, and add it to the list.</p>
            </div>
          </div>

          <div>
            <div class="input-group">
              <label class="input-label" for="taskTitle">Task title</label>
              <input
                id="taskTitle"
                class="input"
                placeholder="Example: Plan weekend trip, Clean the kitchen, Study session..."
              />
            </div>

            <div class="input-group">
              <label class="input-label" for="taskNotes">Notes (optional)</label>
              <input
                id="taskNotes"
                class="input input-small"
                placeholder="Short description or next step..."
              />
            </div>

            <div class="input-row">
              <div class="input-group">
                <label class="input-label" for="taskDue">Due (optional)</label>
                <input id="taskDue" type="date" class="input input-small" />
              </div>

              <div class="input-group" style="flex: 1.5;">
                <span class="input-label">Priority</span>
                <div class="chip-row" id="priorityChips">
                  <button type="button" class="chip active" data-priority="medium">
                    <span class="dot"></span>
                    Medium
                  </button>
                  <button type="button" class="chip" data-priority="low">
                    <span class="dot"></span>
                    Low
                  </button>
                  <button type="button" class="chip" data-priority="high">
                    <span class="dot"></span>
                    High
                  </button>
                  <button type="button" class="chip" data-priority="urgent">
                    <span class="dot"></span>
                    Urgent
                  </button>
                </div>
              </div>
            </div>

            <div style="margin-top: 10px; display: flex; justify-content: space-between; gap: 8px;">
              <button id="addTaskButton" class="button" type="button">
                <span>＋</span>
                Add task
              </button>
              <button id="clearAllButton" class="button button-ghost" type="button">
                Clear all
              </button>
            </div>

            <p class="subtle-text">
              Tip: Each task can hold multiple subtasks. Use priorities to quickly scan what matters most.
            </p>
          </div>
        </section>

        <section class="card">
          <div class="card-header">
            <div class="card-header-left">
              <h2 class="card-title">Your tasks</h2>
              <p class="card-caption">Track progress, expand subtasks, and stay on top of the day.</p>
            </div>
            <div class="card-header-right">
              <div class="stat-pill">
                <span>Tasks:</span>
                <strong id="taskCount">0</strong>
              </div>
              <div class="stat-pill">
                <span>Done:</span>
                <strong id="taskCompletedCount">0</strong>
              </div>
            </div>
          </div>

          <div style="margin-bottom: 6px;">
            <div class="filters">
              <button class="filter-button active" data-filter="all">
                All
              </button>
              <button class="filter-button" data-filter="active">
                Active
              </button>
              <button class="filter-button" data-filter="completed">
                Completed
              </button>
              <button class="filter-button" data-filter="high">
                <span class="dot"></span>
                High & Urgent
              </button>
              <button class="filter-button" data-filter="today">
                Today
              </button>
            </div>
          </div>

          <div id="taskList" class="task-list"></div>

          <div id="emptyState" class="empty-state" style="display: none;">
            <strong>No tasks yet.</strong> Create your first task on the left.  
            You can share this page and each person will have their own local list.
          </div>

          <div class="footer-note">
            <span>
              Data is stored in your browser’s <code>localStorage</code>.
            </span>
            <span class="badge-mini">
              Aurora layout · v1
            </span>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script>
    const STORAGE_KEY = "aurora_task_list_v1";

    const taskTitleInput = document.getElementById("taskTitle");
    const taskNotesInput = document.getElementById("taskNotes");
    const taskDueInput = document.getElementById("taskDue");
    const addTaskButton = document.getElementById("addTaskButton");
    const clearAllButton = document.getElementById("clearAllButton");
    const priorityChips = document.getElementById("priorityChips");
    const taskListEl = document.getElementById("taskList");
    const taskCountEl = document.getElementById("taskCount");
    const taskCompletedCountEl = document.getElementById("taskCompletedCount");
    const emptyStateEl = document.getElementById("emptyState");
    const filterButtons = document.querySelectorAll(".filter-button");

    let tasks = [];
    let activeFilter = "all";

    function loadTasks() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return [];
        const parsed = JSON.parse(raw);
        if (!Array.isArray(parsed)) return [];
        return parsed;
      } catch (e) {
        console.error("Failed to load tasks:", e);
        return [];
      }
    }

    function saveTasks() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
      } catch (e) {
        console.error("Failed to save tasks:", e);
      }
    }

    function uid() {
      return (
        Date.now().toString(36) +
        Math.random().toString(36).substring(2, 8)
      );
    }

    function getSelectedPriority() {
      const active = priorityChips.querySelector(".chip.active");
      return active ? active.getAttribute("data-priority") : "medium";
    }

    function getPriorityLabel(priority) {
      switch (priority) {
        case "low": return "Low";
        case "medium": return "Medium";
        case "high": return "High";
        case "urgent": return "Urgent";
        default: return "Medium";
      }
    }

    function getPriorityClass(priority) {
      switch (priority) {
        case "low": return "priority-low";
        case "medium": return "priority-medium";
        case "high": return "priority-high";
        case "urgent": return "priority-urgent";
        default: return "priority-medium";
      }
    }

    function formatDate(dateStr) {
      if (!dateStr) return "";
      const d = new Date(dateStr + "T00:00:00");
      if (isNaN(d.getTime())) return dateStr;
      const options = { month: "short", day: "numeric" };
      return d.toLocaleDateString(undefined, options);
    }

    function isToday(dateStr) {
      if (!dateStr) return false;
      const today = new Date();
      const d = new Date(dateStr + "T00:00:00");
      return (
        d.getFullYear() === today.getFullYear() &&
        d.getMonth() === today.getMonth() &&
        d.getDate() === today.getDate()
      );
    }

    function updateStats() {
      const total = tasks.length;
      const completed = tasks.filter(t => t.completed).length;
      taskCountEl.textContent = total;
      taskCompletedCountEl.textContent = completed;
    }

    function applyFilter(task) {
      switch (activeFilter) {
        case "active":
          return !task.completed;
        case "completed":
          return task.completed;
        case "high":
          return task.priority === "high" || task.priority === "urgent";
        case "today":
          return isToday(task.dueDate);
        default:
          return true;
      }
    }

    function renderTasks() {
      taskListEl.innerHTML = "";

      if (!tasks.length) {
        emptyStateEl.style.display = "block";
        updateStats();
        return;
      } else {
        emptyStateEl.style.display = "none";
      }

      const filteredTasks = tasks.filter(applyFilter);

      if (!filteredTasks.length) {
        const info = document.createElement("div");
        info.className = "empty-state";
        info.innerHTML =
          "<strong>No tasks match this filter.</strong> Try switching to 'All' or 'Active'.";
        taskListEl.appendChild(info);
        updateStats();
        return;
      }

      filteredTasks.forEach(task => {
        const taskCard = document.createElement("article");
        taskCard.className = "task-card";
        taskCard.dataset.id = task.id;

        const mainRow = document.createElement("div");
        mainRow.className = "task-main-row";

        const checkboxWrap = document.createElement("div");
        checkboxWrap.className = "checkbox-wrap";
        const checkbox = document.createElement("button");
        checkbox.className = "checkbox" + (task.completed ? " completed" : "");
        checkbox.setAttribute("aria-label", "Toggle completed");
        checkbox.addEventListener("click", () => toggleTaskCompleted(task.id));
        checkboxWrap.appendChild(checkbox);

        const taskContent = document.createElement("div");
        taskContent.className = "task-content";

        const titleRow = document.createElement("div");
        titleRow.className = "task-title-row";

        const title = document.createElement("div");
        title.className = "task-title" + (task.completed ? " completed" : "");
        title.textContent = task.title || "(Untitled task)";
        titleRow.appendChild(title);

        const actionsContainer = document.createElement("div");
        actionsContainer.style.display = "flex";
        actionsContainer.style.flexDirection = "column";
        actionsContainer.style.gap = "4px";

        const actionRowTop = document.createElement("div");
        actionRowTop.className = "task-actions";

        const deleteBtn = document.createElement("button");
        deleteBtn.className = "icon-button danger";
        deleteBtn.innerHTML = "✕ Remove";
        deleteBtn.addEventListener("click", () => deleteTask(task.id));

        const quickCompleteBtn = document.createElement("button");
        quickCompleteBtn.className = "icon-button";
        quickCompleteBtn.innerHTML = task.completed ? "↺ Reset" : "✓ Done";
        quickCompleteBtn.addEventListener("click", () => toggleTaskCompleted(task.id));

        actionRowTop.appendChild(quickCompleteBtn);
        actionRowTop.appendChild(deleteBtn);

        actionsContainer.appendChild(actionRowTop);

        titleRow.appendChild(actionsContainer);
        taskContent.appendChild(titleRow);

        const notesOrMeta = document.createElement("div");
        notesOrMeta.className = "task-meta";

        const priorityChip = document.createElement("span");
        priorityChip.className = "meta-chip";
        const priorityDot = document.createElement("span");
        priorityDot.className = "priority-indicator " + getPriorityClass(task.priority);
        priorityChip.appendChild(priorityDot);
        const priorityText = document.createElement("span");
        priorityText.textContent = getPriorityLabel(task.priority);
        priorityChip.appendChild(priorityText);
        notesOrMeta.appendChild(priorityChip);

        if (task.dueDate) {
          const dueChip = document.createElement("span");
          dueChip.className = "meta-chip";
          const dueLabel = document.createElement("span");
          dueLabel.textContent = "Due";
          const dueText = document.createElement("span");
          dueText.textContent = formatDate(task.dueDate);
          if (isToday(task.dueDate)) {
            dueText.textContent += " · Today";
          }
          dueChip.appendChild(dueLabel);
          dueChip.appendChild(dueText);
          notesOrMeta.appendChild(dueChip);
        }

        if (task.notes) {
          const notesChip = document.createElement("span");
          notesChip.className = "meta-chip";
          notesChip.textContent = task.notes;
          notesOrMeta.appendChild(notesChip);
        }

        taskContent.appendChild(notesOrMeta);

        const subtaskSection = document.createElement("div");
        subtaskSection.className = "subtask-section";

        const subHeader = document.createElement("div");
        subHeader.className = "subtask-header";

        const leftLabel = document.createElement("span");
        const completedSubtasks = task.subtasks.filter(st => st.completed).length;
        leftLabel.textContent = `Subtasks (${completedSubtasks}/${task.subtasks.length})`;

        const toggle = document.createElement("button");
        toggle.type = "button";
        toggle.className = "subtask-toggle";
        toggle.innerHTML = "▾ Show subtasks";
        let collapsed = true;

        const subtaskList = document.createElement("div");
        subtaskList.className = "subtask-list";
        subtaskList.style.display = "none";

        toggle.addEventListener("click", () => {
          collapsed = !collapsed;
          subtaskList.style.display = collapsed ? "none" : "flex";
          toggle.innerHTML = collapsed ? "▾ Show subtasks" : "▴ Hide subtasks";
        });

        subHeader.appendChild(leftLabel);
        subHeader.appendChild(toggle);
        subtaskSection.appendChild(subHeader);

        task.subtasks.forEach(sub => {
          const subItem = document.createElement("div");
          subItem.className = "subtask-item";

          const subCheckboxWrap = document.createElement("div");
          subCheckboxWrap.className = "checkbox-wrap";
          const subCheckbox = document.createElement("button");
          subCheckbox.className = "checkbox" + (sub.completed ? " completed" : "");
          subCheckbox.addEventListener("click", () =>
            toggleSubtaskCompleted(task.id, sub.id)
          );
          subCheckboxWrap.appendChild(subCheckbox);

          const subTitle = document.createElement("div");
          subTitle.className = "subtask-title" + (sub.completed ? " completed" : "");
          subTitle.textContent = sub.title || "(Subtask)";

          const subControls = document.createElement("div");
          subControls.className = "subtask-controls";

          const subDelete = document.createElement("button");
          subDelete.type = "button";
          subDelete.className = "tiny-button";
          subDelete.textContent = "Remove";
          subDelete.addEventListener("click", () =>
            deleteSubtask(task.id, sub.id)
          );

          subControls.appendChild(subDelete);

          const subTextWrap = document.createElement("div");
          subTextWrap.style.flex = "1";
          subTextWrap.appendChild(subTitle);
          subTextWrap.appendChild(subControls);

          subItem.appendChild(subCheckboxWrap);
          subItem.appendChild(subTextWrap);

          subtaskList.appendChild(subItem);
        });

        const subInputRow = document.createElement("div");
        subInputRow.className = "subtask-input-row";

        const subInput = document.createElement("input");
        subInput.type = "text";
        subInput.className = "input input-small";
        subInput.placeholder = "Add a subtask...";

        const subAddBtn = document.createElement("button");
        subAddBtn.type = "button";
        subAddBtn.className = "tiny-button";
        subAddBtn.textContent = "＋ Add";

        subAddBtn.addEventListener("click", () => {
          const title = subInput.value.trim();
          if (!title) return;
          addSubtask(task.id, title);
          subInput.value = "";
        });

        subInput.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            e.preventDefault();
            subAddBtn.click();
          }
        });

        subInputRow.appendChild(subInput);
        subInputRow.appendChild(subAddBtn);

        subtaskList.appendChild(subInputRow);
        subtaskSection.appendChild(subtaskList);

        taskContent.appendChild(subtaskSection);

        mainRow.appendChild(checkboxWrap);
        mainRow.appendChild(taskContent);

        taskCard.appendChild(mainRow);
        taskListEl.appendChild(taskCard);
      });

      updateStats();
    }

    function addTask() {
      const title = taskTitleInput.value.trim();
      const notes = taskNotesInput.value.trim();
      const dueDate = taskDueInput.value || "";
      const priority = getSelectedPriority();

      if (!title) {
        taskTitleInput.focus();
        taskTitleInput.classList.add("shake");
        setTimeout(() => taskTitleInput.classList.remove("shake"), 200);
        return;
      }

      const newTask = {
        id: uid(),
        title,
        notes,
        dueDate,
        priority,
        completed: false,
        subtasks: []
      };

      tasks.unshift(newTask);
      saveTasks();
      renderTasks();
      taskTitleInput.value = "";
      taskNotesInput.value = "";
      taskDueInput.value = "";
      taskTitleInput.focus();
    }

    function deleteTask(id) {
      if (!confirm("Remove this task and all subtasks?")) return;
      tasks = tasks.filter(t => t.id !== id);
      saveTasks();
      renderTasks();
    }

    function toggleTaskCompleted(id) {
      tasks = tasks.map(t => {
        if (t.id === id) {
          const completed = !t.completed;
          return { ...t, completed };
        }
        return t;
      });
      saveTasks();
      renderTasks();
    }

    function addSubtask(taskId, title) {
      tasks = tasks.map(t => {
        if (t.id === taskId) {
          const newSub = { id: uid(), title, completed: false };
          return {
            ...t,
            subtasks: [...t.subtasks, newSub]
          };
        }
        return t;
      });
      saveTasks();
      renderTasks();
    }

    function deleteSubtask(taskId, subtaskId) {
      tasks = tasks.map(t => {
        if (t.id === taskId) {
          return {
            ...t,
            subtasks: t.subtasks.filter(st => st.id !== subtaskId)
          };
        }
        return t;
      });
      saveTasks();
      renderTasks();
    }

    function toggleSubtaskCompleted(taskId, subtaskId) {
      tasks = tasks.map(t => {
        if (t.id === taskId) {
          return {
            ...t,
            subtasks: t.subtasks.map(st => {
              if (st.id === subtaskId) {
                return { ...st, completed: !st.completed };
              }
              return st;
            })
          };
        }
        return t;
      });
      saveTasks();
      renderTasks();
    }

    function clearAllTasks() {
      if (!tasks.length) return;
      if (!confirm("Clear all tasks and subtasks for this browser?")) return;
      tasks = [];
      saveTasks();
      renderTasks();
    }

    function setupPriorityChips() {
      priorityChips.addEventListener("click", (e) => {
        const chip = e.target.closest(".chip");
        if (!chip) return;
        priorityChips.querySelectorAll(".chip").forEach(c => c.classList.remove("active"));
        chip.classList.add("active");
      });
    }

    function setupFilters() {
      filterButtons.forEach(btn => {
        btn.addEventListener("click", () => {
          filterButtons.forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          activeFilter = btn.getAttribute("data-filter") || "all";
          renderTasks();
        });
      });
    }

    function setupEvents() {
      addTaskButton.addEventListener("click", addTask);
      clearAllButton.addEventListener("click", clearAllTasks);

      taskTitleInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          addTask();
        }
      });

      taskNotesInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && e.metaKey) {
          e.preventDefault();
          addTask();
        }
      });
    }

    function init() {
      tasks = loadTasks();
      setupPriorityChips();
      setupFilters();
      setupEvents();
      renderTasks();
    }

    init();
  </script>
</body>
</html>
